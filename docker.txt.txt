Alte Container und Volumes bereinigen

Zuerst alles stoppen und alte Volumes l√∂schen (Achtung: alle bisherigen Daten gehen verloren!):

cd C:\xampp\htdocs\Helpdesk
docker compose down -v
docker volume rm db-vol-name5


-v l√∂scht die Volumes, damit MariaDB keine alten, gesperrten Dateien hat.

Pr√ºfe mit docker volume ls, dass das Volume entfernt wurde.

2Ô∏è‚É£ Compose-Datei richtig anlegen

Erstelle oder bearbeite docker-compose.yml in deinem Projektordner:

version: "3.9"

services:
  db:
    image: mariadb:latest
    environment:
      MARIADB_ROOT_PASSWORD: root
      MARIADB_DATABASE: helpdesk
      MARIADB_USER: helpdesk
      MARIADB_PASSWORD: n
    restart: on-failure:10
    volumes:
      - db-vol:/var/lib/mysql
      - ./db-init:/docker-entrypoint-initdb.d
    networks:
      - helpdesk-net

  pma:
    image: phpmyadmin:latest
    environment:
      PMA_HOST: db
      PMA_PORT: 3306
      PMA_USER: root
      PMA_PASSWORD: root
      PMA_ABSOLUTE_URI: http://localhost:6090/
    ports:
      - "6090:80"
    restart: on-failure:10
    depends_on:
      - db
    networks:
      - helpdesk-net

  php:
    build: ./php-app
    volumes:
      - ./php-app:/var/www/html
    ports:
      - "6091:80"
    depends_on:
      - db
    networks:
      - helpdesk-net

volumes:
  db-vol:
    name: db-vol-name5

networks:
  helpdesk-net:
    driver: bridge


‚ö†Ô∏è Wichtig: environment: muss als Mapping geschrieben werden (KEY: VALUE) ‚Äì keine - davor!

3Ô∏è‚É£ Optional: Init-Skript f√ºr helpdesk-User

Lege im Projektordner db-init/01-helpdesk.sql an:

CREATE DATABASE IF NOT EXISTS helpdesk;
CREATE USER IF NOT EXISTS 'helpdesk'@'%' IDENTIFIED BY 'n';
GRANT ALL PRIVILEGES ON helpdesk.* TO 'helpdesk'@'%';
FLUSH PRIVILEGES;


So wird der Benutzer automatisch verf√ºgbar, auch von phpMyAdmin aus.

4Ô∏è‚É£ Container bauen und starten
docker compose up -d --build


--build stellt sicher, dass auch der PHP-Container neu gebaut wird.

5Ô∏è‚É£ Logs pr√ºfen
docker logs -f helpdesk-db-1


Achte darauf, dass MariaDB ohne Fehler hochf√§hrt.

Wenn alles passt, sollte ein Eintrag wie ready for connections erscheinen.

6Ô∏è‚É£ Zugriff auf phpMyAdmin

√ñffne im Browser:

http://localhost:6090


Login automatisch: Benutzer root, Passwort root

Der helpdesk-User steht ebenfalls bereit: Benutzer helpdesk, Passwort n

Host: db wird automatisch durch PMA_HOST gesetzt ‚Äì kein Eingabefeld n√∂tig.

7Ô∏è‚É£ Zugriff auf deine PHP-App

√ñffne im Browser:

http://localhost:6091


Dein PHP-Frontend l√§uft jetzt direkt √ºber den Container.

üí° Tipp:
Wenn du sp√§ter weitere Datenbanken oder Benutzer anlegen willst, lege einfach weitere .sql-Dateien in db-init/ ‚Äì MariaDB f√ºhrt sie automatisch beim Start aus.
Test im Browser: 
http://localhost:6080/index.php?route=/sql&pos=0&db=kassenbuch&table=buchungsarten
http://localhost:6081/Index.php